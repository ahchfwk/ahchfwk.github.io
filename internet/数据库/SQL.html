<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="创建表1create database &lt;dbname&gt;;   123456# 列名 类型 约束create database Product (    id char(4) not null,    price integer default 0,    primary key (id));  删除表12# 不保留表结构，彻底删除drop table Product  表定义更新12">
<meta property="og:type" content="website">
<meta property="og:title" content="SQL">
<meta property="og:url" content="https://ahchfwk.github.io/internet/%E6%95%B0%E6%8D%AE%E5%BA%93/SQL.html">
<meta property="og:site_name" content="fangweikang个人博客">
<meta property="og:description" content="创建表1create database &lt;dbname&gt;;   123456# 列名 类型 约束create database Product (    id char(4) not null,    price integer default 0,    primary key (id));  删除表12# 不保留表结构，彻底删除drop table Product  表定义更新12">
<meta property="og:locale">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/BDglOVficCPPXPTcIdrdGia6HZzGEAxHsm0X2WQbx1IlNtP4YBKb6vvjgxOicib7cOLic43NPtbM5bZjFBFXPdRY0TQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/BDglOVficCPPXPTcIdrdGia6HZzGEAxHsmDXSckAGUFhwt1YiaZd7fygqHwkia8aATzQy5f83Me3TE6eAMic64t8XmA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/BDglOVficCPPXPTcIdrdGia6HZzGEAxHsmpP5CUQfE0DFvs6or16OOJbpt94cNCfPHN4MawzJXFWtYiafaYUicNKTQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="article:published_time" content="2023-07-19T14:34:46.368Z">
<meta property="article:modified_time" content="2023-07-19T14:34:46.368Z">
<meta property="article:author" content="fangweikang">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mmbiz.qpic.cn/mmbiz_png/BDglOVficCPPXPTcIdrdGia6HZzGEAxHsm0X2WQbx1IlNtP4YBKb6vvjgxOicib7cOLic43NPtbM5bZjFBFXPdRY0TQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://ahchfwk.github.io/internet/数据库/SQL.html"/>





  <title>SQL | fangweikang个人博客</title>
  








<meta name="generator" content="Hexo 6.3.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">fangweikang个人博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">为往圣继绝学</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-internet">
          <a href="/internet/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-desktop"></i> <br />
            
            互联网
          </a>
        </li>
      
        
        <li class="menu-item menu-item-read">
          <a href="/read/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-paper-plane"></i> <br />
            
            读书
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    
    
    
    <div class="post-block page">
      <header class="post-header">

	<h1 class="post-title" itemprop="name headline">SQL</h1>



</header>

      
      
      
      <div class="post-body">
        
        
          <h1 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database <span class="operator">&lt;</span>dbname<span class="operator">&gt;</span>; </span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 列名 类型 约束</span><br><span class="line"><span class="keyword">create</span> database Product (</span><br><span class="line">    id <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    price <span class="type">integer</span> <span class="keyword">default</span> <span class="number">0</span>,</span><br><span class="line">    <span class="keyword">primary</span> key (id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h1 id="删除表"><a href="#删除表" class="headerlink" title="删除表"></a>删除表</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 不保留表结构，彻底删除</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> Product</span><br></pre></td></tr></table></figure>

<h1 id="表定义更新"><a href="#表定义更新" class="headerlink" title="表定义更新"></a>表定义更新</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 增加一列</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> Product <span class="keyword">add</span> <span class="keyword">column</span> name <span class="type">varchar</span>(<span class="number">64</span>);</span><br><span class="line"></span><br><span class="line"># 增加多列</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> Product <span class="keyword">add</span> <span class="keyword">column</span> name <span class="type">varchar</span>(<span class="number">64</span>), <span class="keyword">add</span> <span class="keyword">column</span> type <span class="type">integer</span>;</span><br><span class="line"></span><br><span class="line"># 删除列</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> Product <span class="keyword">drop</span> <span class="keyword">column</span> name, type;</span><br><span class="line"></span><br><span class="line"># 修改表名</span><br><span class="line">rename <span class="keyword">table</span> Product <span class="keyword">to</span> xx;</span><br></pre></td></tr></table></figure>

<h1 id="基础查询"><a href="#基础查询" class="headerlink" title="基础查询"></a>基础查询</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 别名可以用中文，但要加双引号</span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">as</span> &quot;名称&quot; <span class="keyword">from</span> Product;</span><br><span class="line"></span><br><span class="line"># <span class="keyword">distinct</span>只能用在第一个列名前</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> name,type <span class="keyword">from</span> Product;</span><br><span class="line"></span><br><span class="line"># 对<span class="keyword">null</span>只能用<span class="keyword">is</span>和<span class="keyword">is</span> <span class="keyword">not</span>进行判断</span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">from</span> Product <span class="keyword">where</span> name <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>

<h1 id="聚合查询"><a href="#聚合查询" class="headerlink" title="聚合查询"></a>聚合查询</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># <span class="built_in">count</span>(<span class="operator">*</span>)计算所有行（只有count可以用<span class="operator">*</span>参数），<span class="built_in">count</span>(name)不计算name <span class="keyword">is</span> <span class="keyword">null</span>行，sum<span class="operator">/</span>avg<span class="operator">/</span>max<span class="operator">/</span>min也不计算<span class="keyword">null</span>行</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>), <span class="built_in">count</span>(name) <span class="keyword">from</span> Product;</span><br><span class="line"># 使用聚合函数时，<span class="keyword">select</span>只能出现聚合键和聚合函数</span><br><span class="line"># <span class="keyword">having</span>子句只能使用常数、聚合键、聚合函数</span><br><span class="line"># <span class="keyword">where</span>指定行对应的条件，<span class="keyword">having</span>指定组对应的条件</span><br></pre></td></tr></table></figure>

<h1 id="数据更新"><a href="#数据更新" class="headerlink" title="数据更新"></a>数据更新</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 省略列清单的插入</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Product <span class="keyword">values</span> (<span class="string">&#x27;0001&#x27;</span>, <span class="string">&#x27;cap&#x27;</span>, <span class="string">&#x27;2022-01-01&#x27;</span>);</span><br><span class="line"></span><br><span class="line"># 包含列清单和值清单的插入</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Product (id, name, create_time) <span class="keyword">values</span> (<span class="string">&#x27;0001&#x27;</span>, <span class="string">&#x27;cap&#x27;</span>, <span class="string">&#x27;2022-01-01&#x27;</span>);</span><br><span class="line"></span><br><span class="line"># 多行插入</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Product <span class="keyword">values</span> (<span class="string">&#x27;0001&#x27;</span>, <span class="string">&#x27;cap&#x27;</span>, <span class="string">&#x27;2022-01-01&#x27;</span>),(<span class="string">&#x27;0002&#x27;</span>, <span class="string">&#x27;pants&#x27;</span>, <span class="string">&#x27;2022-01-02&#x27;</span>);</span><br><span class="line"></span><br><span class="line"># <span class="keyword">insert</span> <span class="keyword">into</span> ... <span class="keyword">select</span> ...</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> ProductSum (type, sum_price) <span class="keyword">select</span> type, <span class="built_in">sum</span>(price) <span class="keyword">from</span> Product <span class="keyword">group</span> <span class="keyword">by</span> type;</span><br><span class="line"></span><br><span class="line"># 清除数据</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> Product [<span class="keyword">where</span> ...];</span><br><span class="line"></span><br><span class="line"># 更新数据</span><br><span class="line"><span class="keyword">update</span> Product <span class="keyword">set</span> register_data <span class="operator">=</span> <span class="string">&#x27;2022-01-01&#x27;</span>;</span><br><span class="line"></span><br><span class="line"># 多列更新</span><br><span class="line"><span class="keyword">update</span> Product <span class="keyword">set</span> price<span class="operator">=</span>price<span class="operator">*</span><span class="number">2</span>, sale_price<span class="operator">=</span>sale_price<span class="operator">/</span><span class="number">2</span> <span class="keyword">where</span> type <span class="operator">=</span> <span class="string">&#x27;ball&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h1 id="复杂查询"><a href="#复杂查询" class="headerlink" title="复杂查询"></a>复杂查询</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"># 创建视图</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> ProductSum (type, cnt) <span class="keyword">as</span> <span class="keyword">select</span> type <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> Product <span class="keyword">group</span> type;</span><br><span class="line"></span><br><span class="line"># 子查询，子查询原则上最好定义名称</span><br><span class="line"><span class="keyword">select</span> type, cnt <span class="keyword">from</span> (<span class="keyword">select</span> type, <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> Product <span class="keyword">group</span> <span class="keyword">by</span> type) <span class="keyword">as</span> ProductSum;</span><br><span class="line"></span><br><span class="line"># 标量子查询（只返回一行一列），可用在任何单一值的位置，一般用于比较</span><br><span class="line"><span class="keyword">select</span> id, name, price <span class="keyword">from</span> Product <span class="keyword">where</span> price <span class="operator">&gt;</span> (<span class="keyword">select</span> <span class="built_in">avg</span>(price) <span class="keyword">from</span> Product);</span><br><span class="line"><span class="keyword">select</span> id, name, price <span class="keyword">from</span> Product <span class="keyword">group</span> <span class="keyword">by</span> type <span class="keyword">having</span> <span class="built_in">avg</span>(price) <span class="operator">&gt;</span> (<span class="keyword">select</span> <span class="built_in">avg</span>(price) <span class="keyword">from</span> Product);</span><br><span class="line"></span><br><span class="line"># 关联子查询</span><br><span class="line"># 查询大于同类型商品均价的商品</span><br><span class="line"><span class="keyword">select</span> id, name, price <span class="keyword">from</span> Product <span class="keyword">as</span> p1 <span class="keyword">where</span> price <span class="operator">&gt;</span> (<span class="keyword">select</span> <span class="built_in">avg</span>(price) <span class="keyword">from</span> Product <span class="keyword">as</span> p2 <span class="keyword">where</span> p1.type<span class="operator">=</span>p2.type <span class="keyword">group</span> <span class="keyword">by</span> type);</span><br><span class="line"></span><br><span class="line"># 查询和上一年销售额相等的年份</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">year</span> <span class="keyword">from</span> Sale S1 <span class="keyword">where</span> sale <span class="operator">=</span> (<span class="keyword">select</span> sale <span class="keyword">from</span> Sale S2 <span class="keyword">where</span> S2.year <span class="operator">=</span> S1.year<span class="number">-1</span>);</span><br><span class="line"># 关联子查询很多时候和自连接等价</span><br><span class="line"><span class="keyword">select</span> S1.year, S1.sale <span class="keyword">from</span> Sale S1, Sale S2 <span class="keyword">where</span> S1.sale<span class="operator">=</span>S2.sale <span class="keyword">and</span> S2.year <span class="operator">=</span> S1.year<span class="number">-1</span>;</span><br><span class="line"># 查询和上一年销售额相等的年份（年份间有断档）</span><br><span class="line"><span class="keyword">select</span> S1.year, S1.sale <span class="keyword">from</span> Sale S1, Sale S2 <span class="keyword">where</span> S1.sale<span class="operator">=</span>S2.sale <span class="keyword">and</span> S2.year <span class="operator">=</span> (</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(<span class="keyword">year</span>) <span class="keyword">from</span> Sale S3 <span class="keyword">where</span> S1.year <span class="operator">&gt;</span> S3.year)</span><br><span class="line"># 累计求和(用窗口函数更简洁，如果不支持窗口函数可以用此方法)</span><br><span class="line"><span class="keyword">select</span> <span class="type">date</span>, (<span class="keyword">select</span> <span class="built_in">sum</span>(amount) <span class="keyword">from</span> Account A2 <span class="keyword">where</span> A1.date<span class="operator">&gt;=</span>A2.date) <span class="keyword">from</span> Account A1 <span class="keyword">order</span> <span class="keyword">by</span> <span class="type">date</span>;</span><br><span class="line"></span><br><span class="line"># 内连接(<span class="keyword">on</span> 必须在<span class="keyword">from</span>和<span class="keyword">where</span>之间，<span class="keyword">where</span>是对连接的结果做过滤，省略<span class="keyword">inner</span>默认为内连接)</span><br><span class="line">selct A.id, A.name, B.type <span class="keyword">from</span> Product <span class="keyword">as</span> A <span class="keyword">inner</span> <span class="keyword">join</span> ShopProduct <span class="keyword">as</span> B <span class="keyword">on</span> A.id<span class="operator">=</span>B.id;</span><br><span class="line"></span><br><span class="line"># 外连接（<span class="keyword">left</span><span class="operator">/</span><span class="keyword">right</span> <span class="keyword">outer</span> <span class="keyword">join</span>）</span><br><span class="line">selct A.id, A.name, B.type <span class="keyword">from</span> Product <span class="keyword">as</span> A <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> ShopProduct <span class="keyword">as</span> B <span class="keyword">on</span> A.id<span class="operator">=</span>B.id;</span><br><span class="line"></span><br><span class="line"># 交叉连接（笛卡尔积） <span class="keyword">cross</span> <span class="keyword">join</span>，一般不用</span><br><span class="line"></span><br><span class="line"># 满外连接</span><br><span class="line">selct A.id, A.name, B.type <span class="keyword">from</span> Product <span class="keyword">as</span> A <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> ShopProduct <span class="keyword">as</span> B <span class="keyword">on</span> A.id<span class="operator">=</span>B.id </span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">selct A.id, A.name, B.type <span class="keyword">from</span> Product <span class="keyword">as</span> A <span class="keyword">right</span> <span class="keyword">outer</span> <span class="keyword">join</span> ShopProduct <span class="keyword">as</span> B <span class="keyword">on</span> A.id<span class="operator">=</span>B.id <span class="keyword">where</span> A.id <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"># 自连接</span><br><span class="line"># 自连接删除名字重复的行</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> Product P1 <span class="keyword">where</span> rowid<span class="operator">&lt;</span>(<span class="keyword">select</span> <span class="built_in">max</span>(P2.rowid) <span class="keyword">from</span> Product p2 <span class="keyword">where</span> p1.name<span class="operator">=</span>p2.name)</span><br><span class="line"># 用集合的方式删除名字重复的行</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> Product P1 <span class="keyword">where</span> rowid <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> <span class="built_in">max</span>(rowid) <span class="keyword">from</span> Product <span class="keyword">group</span> <span class="keyword">by</span> name)</span><br><span class="line"># 自连按价格降序排序</span><br><span class="line"><span class="keyword">select</span> P1.name, <span class="built_in">max</span>(P1.price), <span class="built_in">count</span>(P2.name)<span class="operator">+</span><span class="number">1</span> <span class="keyword">as</span> rank1 <span class="keyword">from</span> Product P1 <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> product P2 <span class="keyword">on</span> P1.price<span class="operator">&lt;</span>P2.price <span class="keyword">group</span> <span class="keyword">by</span> P1.name <span class="keyword">order</span> <span class="keyword">by</span> rank1;</span><br><span class="line"></span><br><span class="line"># <span class="keyword">having</span></span><br><span class="line"># 求众数</span><br><span class="line"><span class="keyword">select</span> income, <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> cnt <span class="keyword">from</span> Graduate <span class="keyword">group</span> <span class="keyword">by</span> income <span class="keyword">having</span> cnt<span class="operator">&gt;=</span><span class="keyword">all</span>(<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> Graduate <span class="keyword">group</span> <span class="keyword">by</span> income);</span><br><span class="line"></span><br><span class="line"># 求中位数，技巧：一般要根据大小关系生成子集时，用非等值自连接</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(<span class="keyword">distinct</span> income) <span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span> T1.income <span class="keyword">from</span> Graduate T1, Graduate T2 <span class="keyword">group</span> <span class="keyword">by</span> T1.income <span class="keyword">having</span> </span><br><span class="line">    <span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> t1.income<span class="operator">&lt;=</span>T2.income <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>)<span class="operator">&gt;=</span> <span class="built_in">count</span>(<span class="operator">*</span>)<span class="operator">/</span><span class="number">2</span> </span><br><span class="line">    <span class="keyword">and</span> </span><br><span class="line">    <span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> t1.income<span class="operator">&gt;=</span>T2.income <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>)<span class="operator">&gt;=</span> <span class="built_in">count</span>(<span class="operator">*</span>)<span class="operator">/</span><span class="number">2</span></span><br><span class="line">) tmp;</span><br></pre></td></tr></table></figure>

<p>MySQL连接，不写join是笛卡尔积，不写join后面不能写on，只能写where</p>
<p>join等于inner join，不写on也是笛卡尔积</p>
<p>left outer join等于left join，必须写on</p>
<p>where和on的区别：在外连接时，on永远显示主表的全部数据，只对副表过滤（即使on中有左表限制条件，也只影响右表的匹配内容），where是在生成的结果上再次做过滤</p>
<h1 id="函数、谓词、case"><a href="#函数、谓词、case" class="headerlink" title="函数、谓词、case"></a>函数、谓词、case</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 函数 */</span> </span><br><span class="line"># 算数</span><br><span class="line"><span class="built_in">abs</span>()</span><br><span class="line"><span class="built_in">mod</span>(被除数，除数)</span><br><span class="line">round(数值，保留的小数位数)</span><br><span class="line"></span><br><span class="line"># 字符串</span><br><span class="line">concat(str1, str2) <span class="comment">-- 拼接</span></span><br><span class="line">length(str) <span class="comment">-- 长度</span></span><br><span class="line"><span class="built_in">lower</span>(STR), <span class="built_in">upper</span>(str)</span><br><span class="line">replace(str, source, target)</span><br><span class="line"><span class="built_in">substring</span>(str, <span class="keyword">from</span>, step) <span class="comment">-- 从第from开始（包括），截取step位</span></span><br><span class="line"></span><br><span class="line"># 日期</span><br><span class="line"><span class="built_in">current_date</span> <span class="comment">-- 当前日期，不需要括号</span></span><br><span class="line"><span class="built_in">current_time</span> <span class="comment">-- 当前时间</span></span><br><span class="line"><span class="built_in">current_timestamp</span> <span class="comment">-- 当前日期和时间</span></span><br><span class="line"><span class="built_in">extract</span>([<span class="keyword">year</span><span class="operator">|</span><span class="keyword">month</span><span class="operator">|</span><span class="keyword">day</span><span class="operator">|</span><span class="keyword">hour</span><span class="operator">|</span><span class="keyword">minute</span><span class="operator">|</span><span class="keyword">second</span>] <span class="keyword">from</span> <span class="built_in">current_timestamp</span>) <span class="comment">-- 抽取部分日期元素</span></span><br><span class="line"></span><br><span class="line"># 转换</span><br><span class="line"><span class="built_in">cast</span>(<span class="keyword">value</span> <span class="keyword">as</span> targetType) <span class="comment">-- 类型转换，cast (&#x27;001&#x27; as signed integer)</span></span><br><span class="line"><span class="built_in">coalesce</span>(...) <span class="comment">-- 将null转换成其他值,select id, coalesce(name, &#x27;null&#x27;) from Product将name为null的行都替换成字符串‘null’</span></span><br><span class="line"></span><br><span class="line"># 聚合,除count以外的函数，输入为空集则返回<span class="keyword">null</span></span><br><span class="line">count,sum,avg,max,min</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 谓词（特殊的函数，返回值是bool值） */</span></span><br><span class="line"># <span class="keyword">like</span>，<span class="operator">%</span>匹配多个字符，_匹配一个字符</span><br><span class="line"># <span class="keyword">between</span> <span class="keyword">from</span> <span class="keyword">and</span> <span class="keyword">to</span>， 包括<span class="keyword">from</span>和<span class="keyword">to</span></span><br><span class="line"># <span class="keyword">is</span> <span class="keyword">null</span>， <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line"># <span class="keyword">in</span>, <span class="keyword">not</span> <span class="keyword">in</span>，注意<span class="keyword">not</span> <span class="keyword">in</span>参数如果有<span class="keyword">null</span>，条件恒不成立</span><br><span class="line"><span class="keyword">select</span> name, price <span class="keyword">from</span> Product <span class="keyword">where</span> id <span class="keyword">in</span> (<span class="string">&#x27;001&#x27;</span>, <span class="string">&#x27;002&#x27;</span>);</span><br><span class="line"><span class="keyword">select</span> name, price <span class="keyword">from</span> Product <span class="keyword">where</span> id <span class="keyword">in</span> (<span class="keyword">select</span> id <span class="keyword">from</span> Product <span class="keyword">where</span> price<span class="operator">&lt;</span><span class="number">100</span>);</span><br><span class="line"></span><br><span class="line"># <span class="keyword">exists</span>，判断是否存在满足条件的记录，一般用关联子查询作为参数;别的谓词左右都有参数，但<span class="keyword">exists</span>只有右侧参数; <span class="keyword">not</span> <span class="keyword">exists</span>含义相反</span><br><span class="line"><span class="keyword">select</span> name, price <span class="keyword">from</span> Product <span class="keyword">as</span> p <span class="keyword">where</span> <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> ShopProduct <span class="keyword">as</span> sp <span class="keyword">where</span> sp.shopid<span class="operator">=</span><span class="string">&#x27;00C&#x27;</span> <span class="keyword">and</span> sp.id<span class="operator">=</span>p.id);</span><br><span class="line"># 查询所有科目都及格的学生</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> sid <span class="keyword">from</span> Score S1 <span class="keyword">where</span> <span class="keyword">not</span> <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> Score S2 <span class="keyword">where</span> S1.sid<span class="operator">=</span>S2.sid <span class="keyword">and</span> S2.score<span class="operator">&lt;</span><span class="number">60</span>);</span><br><span class="line"># 等价的<span class="keyword">having</span>写法</span><br><span class="line"><span class="keyword">select</span> sid <span class="keyword">from</span> Score <span class="keyword">group</span> <span class="keyword">by</span> sid <span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="operator">=</span> <span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> score<span class="operator">&lt;</span><span class="number">60</span> <span class="keyword">then</span> <span class="number">0</span> <span class="keyword">else</span> <span class="number">1</span> <span class="keyword">end</span>);</span><br><span class="line"># 查询连续head_cnt个空座</span><br><span class="line"><span class="keyword">select</span> S1.seat, S2.seat <span class="keyword">from</span> Seat S1, Seat S2 <span class="keyword">where</span> S2.seat<span class="operator">=</span>S1.seat<span class="operator">+</span>head_cnt <span class="keyword">and</span> <span class="keyword">not</span> <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> Seat S3 <span class="keyword">where</span> S3.seat <span class="keyword">between</span> S1.seat <span class="keyword">and</span> S2.seat <span class="keyword">and</span> S3.status<span class="operator">=</span><span class="string">&#x27;已预定&#x27;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* case表达式 */</span></span><br><span class="line"># <span class="keyword">case</span>表达式可以出现在任何可以使用表达式的位置,搜索<span class="keyword">case</span>包含了简单<span class="keyword">case</span>的全部功能</span><br><span class="line"># 注意事项：<span class="number">1.</span>各分支返回类型统一 <span class="number">2.</span>不要忘了<span class="keyword">END</span> <span class="number">3.</span>最好加上<span class="keyword">ELSE</span></span><br><span class="line"># 搜索<span class="keyword">case</span>表达式</span><br><span class="line"><span class="keyword">select</span> name, </span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">when</span> type<span class="operator">=</span><span class="string">&#x27;衣服&#x27;</span> <span class="keyword">then</span> <span class="string">&#x27;A&#x27;</span></span><br><span class="line">         <span class="keyword">when</span> type<span class="operator">=</span><span class="string">&#x27;鞋子&#x27;</span> <span class="keyword">then</span> <span class="string">&#x27;B&#x27;</span></span><br><span class="line">         <span class="keyword">when</span> type<span class="operator">=</span><span class="string">&#x27;帽子&#x27;</span> <span class="keyword">then</span> <span class="string">&#x27;C&#x27;</span></span><br><span class="line">         <span class="keyword">else</span> <span class="keyword">null</span> </span><br><span class="line">    <span class="keyword">end</span> <span class="keyword">as</span> simple_type</span><br><span class="line"><span class="keyword">from</span> Product;</span><br><span class="line"></span><br><span class="line"># 一条<span class="keyword">sql</span>进行不同的条件统计</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> type<span class="operator">=</span><span class="string">&#x27;衣服&#x27;</span> <span class="keyword">then</span> price <span class="keyword">else</span> <span class="number">0</span>) <span class="keyword">as</span> clothse_price, </span><br><span class="line">       <span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> type<span class="operator">=</span><span class="string">&#x27;鞋子&#x27;</span> <span class="keyword">then</span> price <span class="keyword">else</span> <span class="number">0</span>) <span class="keyword">as</span> shoes_price,</span><br><span class="line">       <span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> type<span class="operator">=</span><span class="string">&#x27;帽子&#x27;</span> <span class="keyword">then</span> price <span class="keyword">else</span> <span class="number">0</span>) <span class="keyword">as</span> cap_price</span><br><span class="line"><span class="keyword">from</span> Product;</span><br><span class="line"></span><br><span class="line"># <span class="keyword">check</span>约束定义多个列的条件关系</span><br><span class="line"><span class="keyword">constraint</span> check_salary <span class="keyword">check</span> (<span class="keyword">case</span> <span class="keyword">when</span> sex<span class="operator">=</span><span class="string">&#x27;female&#x27;</span> </span><br><span class="line">                                    <span class="keyword">then</span> <span class="keyword">case</span> <span class="keyword">when</span> salary<span class="operator">&lt;=</span><span class="number">300000</span></span><br><span class="line">                                              <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span></span><br><span class="line">                                    <span class="keyword">else</span> <span class="number">1</span> </span><br><span class="line">                               <span class="keyword">end</span> <span class="operator">=</span> <span class="number">1</span>);</span><br><span class="line">                               </span><br><span class="line"># 更新操作中用<span class="keyword">case</span></span><br><span class="line"><span class="keyword">update</span> Salary <span class="keyword">set</span> salary <span class="operator">=</span> <span class="keyword">case</span> <span class="keyword">when</span> salary <span class="operator">&gt;=</span> <span class="number">300000</span> <span class="keyword">then</span> salary<span class="operator">*</span><span class="number">0.9</span></span><br><span class="line">                                <span class="keyword">when</span> salary <span class="operator">&gt;=</span> <span class="number">250000</span> <span class="keyword">and</span> salary<span class="operator">&lt;</span><span class="number">300000</span> <span class="keyword">then</span> salary<span class="operator">*</span><span class="number">1.2</span></span><br><span class="line">                                <span class="keyword">else</span> salary <span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 简单<span class="keyword">case</span>表达式</span><br><span class="line"><span class="keyword">select</span> name, </span><br><span class="line">    <span class="keyword">case</span> type </span><br><span class="line">         <span class="keyword">when</span> <span class="string">&#x27;衣服&#x27;</span> <span class="keyword">then</span> <span class="string">&#x27;A&#x27;</span></span><br><span class="line">         <span class="keyword">when</span> <span class="string">&#x27;鞋子&#x27;</span> <span class="keyword">then</span> <span class="string">&#x27;B&#x27;</span></span><br><span class="line">         <span class="keyword">when</span> <span class="string">&#x27;帽子&#x27;</span> <span class="keyword">then</span> <span class="string">&#x27;C&#x27;</span></span><br><span class="line">         <span class="keyword">else</span> <span class="keyword">null</span> </span><br><span class="line">    <span class="keyword">end</span> <span class="keyword">as</span> simple_type</span><br><span class="line"><span class="keyword">from</span> Product;</span><br></pre></td></tr></table></figure>

<h1 id="集合运算"><a href="#集合运算" class="headerlink" title="集合运算"></a>集合运算</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 注意事项，列数相同，类型一致，<span class="keyword">order</span> <span class="keyword">by</span>只能用在最后</span><br><span class="line"># <span class="keyword">intersect</span>比<span class="keyword">union</span>和<span class="keyword">except</span>优先级高</span><br><span class="line"># 并集(会去除重复行)</span><br><span class="line"><span class="keyword">select</span> id, name <span class="keyword">from</span> Product <span class="keyword">union</span> <span class="keyword">select</span> id, name <span class="keyword">from</span> Product2;</span><br><span class="line"></span><br><span class="line"># 并集(不去除重复行)</span><br><span class="line"><span class="keyword">select</span> id, name <span class="keyword">from</span> Product <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> id, name <span class="keyword">from</span> Product2;</span><br><span class="line"></span><br><span class="line"># 交集</span><br><span class="line"><span class="keyword">select</span> id, name <span class="keyword">from</span> Product <span class="keyword">intersect</span> <span class="keyword">select</span> id, name <span class="keyword">from</span> Product2;</span><br><span class="line"></span><br><span class="line"># 差集（mysql不支持）</span><br><span class="line"><span class="keyword">select</span> id, name <span class="keyword">from</span> Product <span class="keyword">except</span> <span class="keyword">select</span> id, name <span class="keyword">from</span> Product2;</span><br></pre></td></tr></table></figure>

<h1 id="SQL高级处理"><a href="#SQL高级处理" class="headerlink" title="SQL高级处理"></a>SQL高级处理</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 窗口函数,原则上只能在select子句使用，mysql8.0开始支持 */</span></span><br><span class="line"># 包括聚合函数，rank，dense_rank，row_number</span><br><span class="line"># <span class="operator">&lt;</span>窗口函数<span class="operator">&gt;</span> <span class="keyword">over</span> ([<span class="keyword">partition</span> <span class="keyword">by</span> <span class="operator">&lt;</span>列清单<span class="operator">&gt;</span>] <span class="keyword">order</span> <span class="keyword">by</span> <span class="operator">&lt;</span>排序用列清单<span class="operator">&gt;</span>)</span><br><span class="line"># 省略<span class="keyword">partition</span>相当于将整个结果当一个窗口</span><br><span class="line"># 按照type分组，并按照价格排序</span><br><span class="line"><span class="keyword">select</span> id, name, <span class="built_in">rank</span>() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> type <span class="keyword">order</span> <span class="keyword">by</span> price) <span class="keyword">as</span> ranking <span class="keyword">from</span> Product;</span><br><span class="line"></span><br><span class="line"># 累计求和，每行只计算到本行为止的和</span><br><span class="line"><span class="keyword">select</span> id, name, <span class="built_in">sum</span>(price) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> price) <span class="keyword">as</span> ranking <span class="keyword">from</span> Product;</span><br><span class="line"></span><br><span class="line"># 移动平均，只计算本行和前<span class="number">2</span>行的平均值；后用following</span><br><span class="line"><span class="keyword">select</span> id, name, <span class="built_in">avg</span>(price) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> price <span class="keyword">rows</span> <span class="number">2</span> precending) <span class="keyword">as</span> ranking <span class="keyword">from</span> Product;</span><br><span class="line"></span><br><span class="line"># 窗口函数的<span class="keyword">order</span> <span class="keyword">by</span>只规定按照什么样的顺序计算，结果的排序还要另加<span class="keyword">order</span> <span class="keyword">by</span></span><br><span class="line"><span class="keyword">select</span> id, name, <span class="built_in">rank</span>() <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> price) <span class="keyword">as</span> ranking <span class="keyword">from</span> Product <span class="keyword">order</span> <span class="keyword">by</span> ranking;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* grouping函数 */</span></span><br><span class="line"># 同时计算小计和合计</span><br><span class="line"><span class="keyword">select</span> name, <span class="built_in">sum</span>(price) <span class="keyword">from</span> Product <span class="keyword">group</span> <span class="keyword">by</span> type <span class="keyword">with</span> <span class="keyword">rollup</span>;</span><br><span class="line"></span><br><span class="line"># 对所有的分组子集做<span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line"><span class="keyword">select</span> name, <span class="built_in">sum</span>(price) <span class="keyword">from</span> Product <span class="keyword">group</span> <span class="keyword">by</span> type <span class="keyword">with</span> <span class="keyword">cube</span>;</span><br><span class="line"># <span class="keyword">grouping</span> sets 只取出部分记录, 例如<span class="keyword">grouping</span> sets(type, <span class="type">date</span>)只取出按这两个维度分组的记录</span><br><span class="line"># <span class="keyword">grouping</span>函数，而<span class="keyword">grouping</span>函数用来区分是否是超级分组记录，是为<span class="number">1</span>否为<span class="number">0</span></span><br></pre></td></tr></table></figure>



<h1 id="SQL书写和执行顺序"><a href="#SQL书写和执行顺序" class="headerlink" title="SQL书写和执行顺序"></a>SQL书写和执行顺序</h1><p><strong>书写顺序</strong>：SELECT -&gt; FROM -&gt; JOIN -&gt; ON -&gt; WHERE -&gt; GROUP BY -&gt; HAVING -&gt; UNION -&gt; ORDER BY -&gt;LIMIT</p>
<p><strong>执行顺序</strong>：FROM -&gt; ON -&gt; JOIN -&gt; WHERE -&gt; GROUP BY -&gt; HAVING -&gt; SELECT -&gt; UNION -&gt; ORDER BY -&gt;LIMIT</p>
<h1 id="MySQL数据类型"><a href="#MySQL数据类型" class="headerlink" title="MySQL数据类型"></a>MySQL数据类型</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">整数类型，分别8/16/24/32/64位，都可以加上unsigned属性；类似int(11)这样的写法只是控制显示宽度</span><br><span class="line">tinyint, smallint, mediumint, int, bigint</span><br><span class="line"></span><br><span class="line">实数类型, decimal存储精确的小数，值保存在二进制字符串中，通常可以使用bigint代替decimal以提高效率</span><br><span class="line">decimal, float, double</span><br><span class="line"></span><br><span class="line">VARCHAR和CHAR类型</span><br><span class="line">varchar需要一个/两个额外字节存储长度；char存储时会在尾部补齐空格，所以如果原值含有尾部空格，检索时则会丢失;类似的还有varbinary和binary</span><br><span class="line"></span><br><span class="line">[tiny/small/medium/long]BLOB, [tiny/small/medium/long]TEXT类型</span><br><span class="line">分别用二进制和字符方式存储很大的数据，少用，Memory引擎不支持，性能开销大</span><br><span class="line"></span><br><span class="line">enum类型</span><br><span class="line">实际存储为整数，缺点是添加枚举需要alter table</span><br><span class="line"></span><br><span class="line">日期和时间类型</span><br><span class="line">YEAR, TIME, DATE, DATETIME, TIMESTAMP</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong> 整数类型和浮点数类型可以统称为数值数据类型。</p>
<ul>
<li><strong>数值类型</strong>：整数类型包括 TINYINT、SMALLINT、MEDIUMINT、INT、BIGINT，浮点数类型包括 FLOAT 和 DOUBLE，定点数类型为 DECIMAL。</li>
<li><strong>日期&#x2F;时间类型</strong>：包括 YEAR、TIME、DATE、DATETIME 和 TIMESTAMP。</li>
<li><strong>字符串类型</strong>：包括 CHAR、VARCHAR、BINARY、VARBINARY、BLOB、TEXT、ENUM 和 SET 等。</li>
<li><strong>二进制类型</strong>：包括 BIT、BINARY、VARBINARY、TINYBLOB、BLOB、MEDIUMBLOB 和 LONGBLOB。</li>
</ul>
<hr>
<h2 id="1-数值类型"><a href="#1-数值类型" class="headerlink" title="1 数值类型"></a>1 数值类型</h2><h3 id="1-1-整数类型"><a href="#1-1-整数类型" class="headerlink" title="1.1 整数类型"></a><strong>1.1</strong> <strong>整数类型</strong></h3><p>MySQL 主要提供的整数类型有 <code>TINYINT</code>、<code>SMALLINT</code>、<code>MEDIUMINT</code>、<code>INT</code>、<code>BIGINT</code>，分别占1&#x2F;2&#x2F;3&#x2F;4&#x2F;8个字节，其属性字段可以添加 <code>AUTO_INCREMENT</code> 自增约束条件。</p>
<p><strong>提示：</strong> 显示宽度和数据类型的取值范围是无关的。显示宽度只是指明 MySQL 最大可能显示的数字个数，数值的位数小于指定的宽度时会由空格填充。如果插入了大于显示宽度的值，只要该值不超过该类型整数的取值范围，数值依然可以插入，而且能够显示出来。例如，类似int(11)这样的写法只是控制显示宽度；year 字段插入 19999，当使用 SELECT 查询该列值的时候，MySQL 显示的将是完整的带有 5 位数字的 19999，而不是 4 位数字的值。</p>
<p>其他整型数据类型也可以在定义表结构时指定所需的显示宽度，如果不指定，则系统为每一种类型指定默认的宽度值。</p>
<p>不同的整数类型有不同的取值范围，并且需要不同的存储空间，因此应根据实际需要选择最合适的类型，这样有利于提高查询的效率和节省存储空间。</p>
<h3 id="1-2-浮点类型"><a href="#1-2-浮点类型" class="headerlink" title="1.2 浮点类型"></a>1.2 浮点类型</h3><p>MySQL 中使用浮点数和定点数来表示小数。</p>
<p>浮点类型有两种，分别是单精度浮点数（<code>FLOAT</code>）和双精度浮点数（<code>DOUBLE</code>）；定点类型只有一种，就是 <code>DECIMAL</code>。</p>
<p>浮点类型和定点类型都可以用<code>(M, D)</code>来表示，其中 <code>M</code> 称为精度，表示总共的位数；<code>D</code> 称为标度，表示小数的位数。</p>
<p>浮点数类型的取值范围为 M（1～255）和 D（1～30，且不能大于 M-2），分别表示显示宽度和小数位数。M 和 D 在 FLOAT 和DOUBLE 中是可选的，FLOAT 和 DOUBLE 类型将被保存为硬件所支持的最大精度。DECIMAL 的默认 D 值为 0、M 值为 10。</p>
<p><code>DECIMAL</code> 类型不同于 <code>FLOAT</code> 和 <code>DOUBLE</code>。<code>DOUBLE</code> 实际上是以<strong>二进制字符串</strong>的形式存放的，<code>DECIMAL</code> 可能的最大取值范围与 <code>DOUBLE</code> 相同，但是有效的取值范围由 <code>M</code> 和 <code>D</code> 决定。如果改变 <code>M</code> 而固定 <code>D</code>，则取值范围将随 <code>M</code> 的变大而变大。通常可以使用bigint代替decimal以提高效率。</p>
<p>从上表中可以看到，<code>DECIMAL</code> 的存储空间并不是固定的，而由精度值 <code>M</code> 决定，占用 <code>M+2</code> 个字节。</p>
<p><strong>提示：</strong></p>
<ul>
<li>不论是定点还是浮点类型，如果用户指定的精度超出精度范围，则会四舍五入进行处理。</li>
<li><code>FLOAT</code> 和 <code>DOUBLE</code> 在不指定精度时，默认会按照实际的精度（由计算机硬件和操作系统决定），<code>DECIMAL</code> 如果不指定精度，默认为（10，0）。</li>
<li>浮点数相对于定点数的优点是在长度一定的情况下，浮点数能够表示更大的范围；缺点是会引起精度问题。</li>
<li>在 MySQL 中，定点数以字符串形式存储，在对精度要求比较高的时候（如货币、科学数据），使用 <code>DECIMAL</code> 的类型比较好</li>
<li>另外两个浮点数进行减法和比较运算时也容易出问题，所以在使用浮点数时需要注意，并尽量避免做浮点数比较。</li>
</ul>
<hr>
<h2 id="2-日期和时间类型"><a href="#2-日期和时间类型" class="headerlink" title="2 日期和时间类型"></a>2 日期和时间类型</h2><p>MySQL 中有多处表示日期的数据类型：<code>YEAR</code>、<code>TIME</code>、<code>DATE</code>、<code>DTAETIME</code>、<code>TIMESTAMP</code>。当只记录年信息的时候，可以只使用 <code>YEAR</code> 类型。</p>
<p>每一个类型都有合法的取值范围，当指定确定不合法的值时，系统将“零”值插入数据库中。</p>
<h3 id="2-1-YEAR-类型"><a href="#2-1-YEAR-类型" class="headerlink" title="2.1 YEAR 类型"></a><strong>2.1</strong> <strong>YEAR 类型</strong></h3><p>YEAR 类型是一个单字节类型，用于表示年，在存储时只需要 1 个字节。可以使用各种格式指定 YEAR，如下所示：</p>
<ul>
<li>以 <strong>4 位字符串</strong>或者 <strong>4 位数字</strong>格式表示的 YEAR，范围为 ‘1901’～’2155’。输入格式为 ‘YYYY’ 或者 YYYY，例如，输入 ‘2010’ 或 2010，插入数据库的值均为 2010。</li>
<li>以 <strong>2 位字符串</strong>格式表示的 YEAR，范围为 ‘00’ 到 ‘99’。’00’～’69’ 和 ‘70’～’99’ 范围的值分别被转换为 2000～2069 和 1970～1999 范围的 YEAR 值。’0’ 与 ‘00’ 的作用相同。插入超过取值范围的值将被转换为 2000。</li>
<li>以 <strong>2 位数字</strong>表示的 YEAR，范围为 1～99。1～99 和 70～99 范围的值分别被转换为 2001～2069 和 1970～1999 范围的 YEAR 值。注意，在这里 0 值将被转换为 0000，而不是 2000。</li>
</ul>
<p><strong>提示：</strong> 两位整数范围与两位字符串范围稍有不同。例如，插入 3000 年，读者可能会使用数字格式的 0 表示 YEAR，实际上，插入数据库的值为 0000，而不是所希望的 3000。只有使用字符串格式的 ‘0’ 或 ‘00’，才可以被正确解释为 3000，非法 YEAR值将被转换为 0000。</p>
<h3 id="2-2-TIME-类型"><a href="#2-2-TIME-类型" class="headerlink" title="2.2 TIME 类型"></a>2.2 TIME 类型</h3><p>TIME 类型用于只需要时间信息的值，在存储时需要 3 个字节。格式为 <code>HH:MM:SS</code>。<code>HH</code> 表示小时，<code>MM</code> 表示分钟，<code>SS</code> 表示秒。</p>
<p>TIME 类型的取值范围为 <code>-838：59：59～838：59：59</code>，小时部分如此大的原因是 TIME 类型不仅可以用于表示一天的时间（必须小于 24 小时），还可能是某个事件过去的时间或两个事件之间的时间间隔（可大于 24 小时，或者甚至为负）。</p>
<p>可以使用各种格式指定 TIME 值，如下所示。</p>
<ul>
<li>‘<code>D HH：MM：SS</code>‘ 格式的字符串。还可以使用这些“非严格”的语法：’<code>HH：MM：SS</code>‘、’<code>HH：MM</code>‘、’<code>D HH</code>‘ 或 ‘<code>SS</code>‘。这里的 <code>D</code> 表示日，可以取 0～34 之间的值。在插入数据库时，<code>D</code> 被转换为小时保存，格式为 “<code>D*24+HH</code>”。</li>
<li>‘<code>HHMMSS</code>‘ 格式、没有间隔符的字符串或者 <code>HHMMSS</code> 格式的数值，假定是有意义的时间。例如，’101112’ 被理解为’10：11：12’，但是 ‘106112’ 是不合法的（它有一个没有意义的分钟部分），在存储时将变为 00：00：00。</li>
</ul>
<p><strong>为 TIME 列分配简写值时应注意：</strong></p>
<ul>
<li>如果没有冒号，MySQL 解释值时，假定最右边的两位表示秒。（MySQL 解释 TIME 值为过去的时间而不是当前的时间）。例如，读者可能认为 ‘1112’ 和 1112 表示 11：12：00（即 11 点过 12 分钟），但MySQL 将它们解释为 00：11：12（即 11 分 12 秒）。同样 ‘12’ 和 12 被解释为00：00：12。</li>
<li>相反，TIME 值中如果使用冒号则肯定被看作当天的时间，也就是说，’11：12’ 表示 11：12：00，而不是 00：11：12。</li>
</ul>
<h3 id="2-3-DATE-类型"><a href="#2-3-DATE-类型" class="headerlink" title="2.3 DATE 类型"></a>2.3 DATE 类型</h3><p>DATE 类型用于仅需要日期值时，没有时间部分，在存储时需要 3 个字节。日期格式为 ‘<code>YYYY-MM-DD</code>‘，其中 <code>YYYY</code> 表示年，<code>MM</code> 表示月，<code>D</code>D 表示日。</p>
<p>在给 DATE 类型的字段赋值时，可以使用字符串类型或者数字类型的数据插入，只要符合 DATE 的日期格式即可。如下所示：</p>
<ul>
<li>以 ‘<code>YYYY-MM-DD</code>‘ 或者 ‘<code>YYYYMMDD</code>‘ 字符中格式表示的日期，取值范围为 ‘1000-01-01’～’9999-12-3’。例如，输入 ‘2015-12-31’ 或者 ‘20151231’，插入数据库的日期为2015-12-31。</li>
<li>以 ‘<code>YY-MM-DD</code>‘ 或者 ‘<code>YYMMDD</code>‘ 字符串格式表示日期，在这里YY表示两位的年值。MySQL 解释两位年值的规则：’00～69’ 范围的年值转换为 ‘2000-2069’，’70-99’ 范围的年值转换为 ‘1970～1999’。例如，输入 ‘15-12-31’，插入数据库的日期为 2015-12-31；输入 ‘991231’，插入数据库的日期为 1999-12-31。</li>
<li>以<code>YYMMDD</code> 数字格式表示的日期，与前面相似，00~69 范围的年值转换为 2000～2069，80～99 范围的年值转换为 1980～1999。例如，输入 151231，插入数据库的日期为 2015-12-31，输入 991231，插入数据库的日期为 1999-12-31。</li>
<li>使用 <code>CURRENT_DATE</code> 或者 <code>NOW()</code>，插入当前系统日期。</li>
</ul>
<p><strong>MySQL 允许“不严格”语法：</strong> 任何标点符号都可以用作日期部分之间的间隔符。例如，’98-11-31’、’98.11.31’、’98&#x2F;11&#x2F;31’和‘98@11@31’ 是等价的，这些值也可以正确地插入数据库。</p>
<h3 id="2-4-DATETIME-类型"><a href="#2-4-DATETIME-类型" class="headerlink" title="2.4 DATETIME 类型"></a>2.4 DATETIME 类型</h3><p>DATETIME 类型用于需要同时包含日期和时间信息的值，在存储时需要 8 个字节。日期格式为 ‘<code>YYYY-MM-DD HH：MM：SS</code>‘，其中 <code>YYYY</code> 表示年，<code>MM</code> 表示月，<code>DD</code> 表示日，<code>HH</code> 表示小时，<code>MM</code> 表示分钟，<code>SS</code> 表示秒。</p>
<p>在给 DATETIME 类型的字段赋值时，可以使用字符串类型或者数字类型的数据插入，只要符合 DATETIME 的日期格式即可，如下所示。</p>
<ul>
<li>以 ‘<code>YYYY-MM-DD HH：MM：SS</code>‘ 或者 ‘<code>YYYYMMDDHHMMSS</code>‘ 字符串格式表示的日期，<strong>取值范围</strong>为 ‘1000-01-01 00：00：00’～’9999-12-3 23：59：59’。例如，输入 ‘2014-12-31 05：05：05’ 或者 ‘20141231050505’，插入数据库的 DATETIME 值都为 2014-12-31 05：05：05。</li>
<li>以 ‘<code>YY-MM-DD HH：MM：SS</code>‘ 或者 ‘<code>YYMMDDHHMMSS</code>‘ 字符串格式表示的日期，在这里 YY 表示两位的年值。与前面相同，’00～79’ 范围的年值转换为 ‘2000～2079’，’80～99’ 范围的年值转换为 ‘1980～1999’。例如，输入 ‘14-12-31 05：05：05’，插入数据库的 DATETIME 为 2014-12-31 05：05：05；输入 141231050505，插入数据库的 DATETIME 为 2014-12-31 05：05：05。</li>
<li>以 <code>YYYYMMDDHHMMSS</code> 或者 <code>YYMMDDHHMMSS</code> 数字格式表示的日期和时间。例如，输入 20141231050505，插入数据库的 DATETIME 为 2014-12-31 05：05：05；输入 140505050505，插入数据库的 DATETIME 为 2014-12-31 05：05：05。</li>
</ul>
<p><strong>MySQL 允许“不严格”语法：</strong> 任何标点符号都可用作日期部分或时间部分之间的间隔符。例如，’98-12-31 11：30：45’、’98.12.31 11+30+35’、’98&#x2F;12&#x2F;31 11<em>30</em>45’ 和 ‘98@12@31 11^30^45’ 是等价的，这些值都可以正确地插入数据库。</p>
<h3 id="2-5-TIMESTAMP-类型"><a href="#2-5-TIMESTAMP-类型" class="headerlink" title="2.5 TIMESTAMP 类型"></a>2.5 TIMESTAMP 类型</h3><p>TIMESTAMP 的显示格式与 DATETIME 相同，显示宽度固定在 19 个字符，日期格式为 <code>YYYY-MM-DD HH：MM：SS</code>，在存储时需要 4 个字节。但是 TIMESTAMP 列的<strong>取值范围</strong>小于 <code>DATETIME</code> 的取值范围，为 ‘1970-01-01 00：00：01’UTC～’2038-01-19 03：14：07’UTC。在插入数据时，要保证在合法的取值范围内。</p>
<p><strong>提示：</strong> 协调世界时（英：Coordinated Universal Time，法：Temps Universel Coordonné）又称为世界统一时间、世界标准时间、国际协调时间。英文（CUT）和法文（TUC）的缩写不同，作为妥协，简称 UTC。</p>
<p><code>TIMESTAMP</code> 与 <code>DATETIME</code> 除了存储字节和支持的范围不同外，还有一个最大的区别是：</p>
<ul>
<li>DATETIME 在存储日期数据时，按实际输入的格式存储，即输入什么就存储什么，与时区无关；</li>
<li>而 TIMESTAMP 值的存储是以 UTC（世界标准时间）格式保存的，存储时对当前时区进行转换，检索时再转换回当前时区。即查询时，根据当前时区的不同，显示的时间值是不同的。</li>
</ul>
<p><strong>提示：</strong> 如果为一个 <code>DATETIME</code> 或 <code>TIMESTAMP</code> 对象分配一个 <code>DATE</code> 值，结果值的时间部分被设置为 ‘00：00：00’，因此 DATE 值未包含时间信息。如果为一个 DATE 对象分配一个 DATETIME 或 TIMESTAMP 值，结果值的时间部分被删除，因此DATE 值未包含时间信息。</p>
<hr>
<h2 id="3-字符串类型"><a href="#3-字符串类型" class="headerlink" title="3 字符串类型"></a>3 字符串类型</h2><p>字符串类型用来存储字符串数据，还可以存储图片和声音的二进制数据。字符串可以区分或者不区分大小写的串比较，还可以进行正则表达式的匹配查找。</p>
<p>MySQL 中的字符串类型有 CHAR、VARCHAR、TINYTEXT、TEXT、MEDIUMTEXT、LONGTEXT、ENUM、SET 等。</p>
<p>下表中列出了 MySQL 中的字符串数据类型，括号中的 M 表示可以为其指定长度。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/BDglOVficCPPXPTcIdrdGia6HZzGEAxHsm0X2WQbx1IlNtP4YBKb6vvjgxOicib7cOLic43NPtbM5bZjFBFXPdRY0TQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Image"></p>
<p><code>VARCHAR</code> 和 <code>TEXT</code> 类型是变长类型，其存储需求取决于列值的实际长度（在前面的表格中用 <code>L</code> 表示），而不是取决于类型的最大可能尺寸。</p>
<p>例如，一个 <code>VARCHAR(10)</code> 列能保存一个最大长度为 10 个字符的字符串，实际的存储需要字符串的长度 <code>L</code> 加上一个字节以记录字符串的长度。对于字符 “abcd”，<code>L</code> 是 4，而存储要求 5 个字节。</p>
<h3 id="3-1-CHAR-和-VARCHAR-类型"><a href="#3-1-CHAR-和-VARCHAR-类型" class="headerlink" title="3.1 CHAR 和 VARCHAR 类型"></a>3.1 CHAR 和 VARCHAR 类型</h3><p><strong><code>CHAR(M)</code></strong> 为固定长度字符串，在定义时指定字符串列长。当保存时，在右侧<strong>填充空格</strong>以达到指定的长度。<code>M</code> 表示列的长度，范围是 0～255 个字符。</p>
<p>例如，<code>CHAR(4)</code> 定义了一个固定长度的字符串列，包含的字符个数最大为 4。当检索到 CHAR 值时，尾部的空格将被删除。</p>
<p><strong><code>VARCHAR(M)</code></strong> 是长度可变的字符串，<code>M</code> 表示最大列的长度，<code>M</code> 的范围是 <code>0～65535</code>。<code>VARCHAR</code> 的最大实际长度由最长的行的大小和使用的字符集确定，而实际占用的空间为字符串的实际长度加 1。</p>
<p>例如，<code>VARCHAR(50)</code> 定义了一个最大长度为 50 的字符串，如果插入的字符串只有 10 个字符，则实际存储的字符串为 10 个字符和一个字符串结束字符。<code>VARCHAR</code> 在值保存和检索时尾部的空格仍保留。</p>
<p>如果存储的值超过长度，超过的部分被截断</p>
<h3 id="3-2-TEXT-类型"><a href="#3-2-TEXT-类型" class="headerlink" title="3.2 TEXT 类型"></a>3.2 TEXT 类型</h3><p>TEXT 列保存非二进制字符串，如文章内容、评论等。当保存或查询 TEXT 列的值时，不删除尾部空格。</p>
<p>TEXT 类型分为 4 种：<code>TINYTEXT</code>、<code>TEXT</code>、<code>MEDIUMTEXT</code> 和 <code>LONGTEXT</code>。不同的 TEXT 类型的存储空间和数据长度不同。</p>
<ul>
<li><code>TINYTEXT</code> 表示长度为 255字符的 TEXT 列。</li>
<li><code>TEXT</code> 表示长度为 65535字符的 TEXT 列。</li>
<li><code>MEDIUMTEXT</code> 表示长度为 16777215字符的 TEXT 列。</li>
<li><code>LONGTEXT</code> 表示长度为 4294967295 或 4GB 字符的 TEXT 列。</li>
</ul>
<h3 id="3-3-ENUM-类型"><a href="#3-3-ENUM-类型" class="headerlink" title="3.3 ENUM 类型"></a>3.3 ENUM 类型</h3><p><code>ENUM</code> 是一个字符串对象，值为表创建时列规定中枚举的一列值。其语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;字段名&gt; ENUM( &#x27;值1&#x27;, &#x27;值1&#x27;, …, &#x27;值n&#x27; )</span><br></pre></td></tr></table></figure>

<p>字段名指将要定义的字段，值 <code>n</code> 指枚举列表中第 <code>n</code> 个值。</p>
<p><code>ENUM</code> 类型的字段在取值时，能在指定的枚举列表中获取，而且一次只能取一个。如果创建的成员中有空格，尾部的空格将自动被删除。</p>
<p><code>ENUM</code> 值在内部用整数表示，每个枚举值均有一个索引值；列表值所允许的成员值从 1 开始编号，MySQL 存储的就是这个索引编号，枚举最多可以有 65535 个元素。</p>
<p>例如，定义 ENUM 类型的列（’first’，’second’，’third’），该列可以取的值和每个值的索引如下表所示。</p>
<table>
<thead>
<tr>
<th>值</th>
<th>索引</th>
</tr>
</thead>
<tbody><tr>
<td>NULL</td>
<td>NULL</td>
</tr>
<tr>
<td>‘’</td>
<td>0</td>
</tr>
<tr>
<td>first</td>
<td>1</td>
</tr>
<tr>
<td>second</td>
<td>2</td>
</tr>
<tr>
<td>third</td>
<td>3</td>
</tr>
</tbody></table>
<p>ENUM 值依照列索引顺序排列，并且空字符串排在非空字符串前，NULL 值排在其他所有枚举值前。</p>
<p><strong>提示：</strong> ENUM 列总有一个默认值。如果将 ENUM 列声明为 <code>NULL</code>，<code>NULL</code> 值则为该列的一个有效值，并且默认值为 <code>NULL</code>。如果 ENUM 列被声明为 <code>NOT NULL</code>，其默认值为允许的值列表的第 1 个元素。</p>
<h3 id="3-4-SET-类型"><a href="#3-4-SET-类型" class="headerlink" title="3.4 SET 类型"></a>3.4 SET 类型</h3><p>SET 是一个字符串的对象，可以有零或多个值，SET 列最多可以有 64 个成员，值为表创建时规定的一列值。指定包括多个 SET 成员的 SET 列值时，各成员之间用逗号,隔开，语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET( &#x27;值1&#x27;, &#x27;值2&#x27;, …, &#x27;值n&#x27; )</span><br></pre></td></tr></table></figure>

<p>与 ENUM 类型相同，SET 值在内部用整数表示，列表中每个值都有一个索引编号。当创建表时，SET 成员值的尾部空格将自动删除。</p>
<p>但与 ENUM 类型不同的是，ENUM 类型的字段只能从定义的列值中选择一个值插入，而 SET 类型的列可从定义的列值中选择多个字符的联合。</p>
<p><strong>提示：</strong> 如果插入 SET 字段中的列值有重复，则 MySQL 自动删除重复的值；插入 SET 字段的值的顺序并不重要，MySQL 会在存入数据库时，按照定义的顺序显示；如果插入了不正确的值，默认情况下，MySQL 将忽视这些值，给出警告。</p>
<h2 id="4-二进制类型"><a href="#4-二进制类型" class="headerlink" title="4 二进制类型"></a>4 二进制类型</h2><p>MySQL 支持两类字符型数据：文本字符串和二进制字符串。二进制字符串类型有时候也直接被称为“二进制类型”。</p>
<p>MySQL 中的二进制字符串有 <code>BIT</code>、<code>BINARY</code>、<code>VARBINARY</code>、<code>TINYBLOB</code>、<code>BLOB</code>、<code>MEDIUMBLOB</code> 和 <code>LONGBLOB</code>。</p>
<p>下表中列出了 MySQL 中的二进制数据类型，括号中的 <code>M</code> 表示可以为其指定长度。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/BDglOVficCPPXPTcIdrdGia6HZzGEAxHsmDXSckAGUFhwt1YiaZd7fygqHwkia8aATzQy5f83Me3TE6eAMic64t8XmA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Image"></p>
<h3 id="4-1-BIT-类型"><a href="#4-1-BIT-类型" class="headerlink" title="4.1 BIT 类型"></a>4.1 BIT 类型</h3><p>位字段类型。M 表示每个值的位数，范围为 1～64。如果 M 被省略，默认值为 1。如果为 BIT(M) 列分配的值的长度小于 M 位，在值的左边用 0 填充。例如，为 BIT(6) 列分配一个值 b’101’，其效果与分配 b’000101’ 相同。</p>
<p>BIT 数据类型用来保存位字段值，例如以二进制的形式保存数据 13，13 的二进制形式为 1101，在这里需要位数至少为 4 位的 BIT 类型，即可以定义列类型为 <code>BIT(4)</code>。大于二进制 1111 的数据是不能插入<code>BIT(4)</code> 类型的字段中的。</p>
<p><strong>提示：</strong> 默认情况下，MySQL 不可以插入超出该列允许范围的值，因而插入数据时要确保插入的值在指定的范围内。</p>
<h3 id="4-2-BINARY-和-VARBINARY-类型"><a href="#4-2-BINARY-和-VARBINARY-类型" class="headerlink" title="4.2 BINARY 和 VARBINARY 类型"></a>4.2 BINARY 和 VARBINARY 类型</h3><p><code>BINARY</code> 和 <code>VARBINARY</code> 类型类似于 <code>CHAR</code> 和 <code>VARCHAR</code>，不同的是它们包含二进制字节字符串。使用的语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">列名称 BINARY(M) 或者 VARBINARY(M)</span><br></pre></td></tr></table></figure>

<p><strong><code>BINARY</code></strong> 类型的长度是固定的，指定长度后，不足最大长度的，将在它们右边填充 “<code>\0</code>” 补齐，以达到指定长度。例如，指定列数据类型为 <code>BINARY(3)</code>，当插入 <code>a</code> 时，存储的内容实际为 “<code>\a0\0</code>”，当插入 <code>ab</code> 时，实际存储的内容为“<code>ab\0</code>”，无论存储的内容是否达到指定的长度，存储空间均为指定的值 <code>M</code>。</p>
<p><strong><code>VARBINARY</code></strong> 类型的长度是可变的，指定好长度之后，长度可以在 0 到最大值之间。例如，指定列数据类型为 <code>VARBINARY(20)</code>，如果插入的值长度只有 10，则实际存储空间为 10 加 1，实际占用的空间为字符串的实际长度加 1。</p>
<h3 id="4-3-BLOB-类型"><a href="#4-3-BLOB-类型" class="headerlink" title="4.3 BLOB 类型"></a>4.3 BLOB 类型</h3><p>BLOB 是一个二进制的对象，用来存储可变数量的数据。BLOB 类型分为 4 种：TINYBLOB、BLOB、MEDIUMBLOB 和 LONGBLOB，它们可容纳值的最大长度不同，如下表所示。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/BDglOVficCPPXPTcIdrdGia6HZzGEAxHsmpP5CUQfE0DFvs6or16OOJbpt94cNCfPHN4MawzJXFWtYiafaYUicNKTQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Image"></p>
<ul>
<li>BLOB 列存储的是二进制字符串（字节字符串），TEXT 列存储的是非进制字符串（字符字符串）。</li>
<li>BLOB 列是字符集，并且排序和比较基于列值字节的数值；TEXT 列有一个字符集，并且根据字符集对值进行排序和比较。</li>
</ul>

        
      </div>
      
      
      
    </div>
    
    
    
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8"><span class="nav-number">1.</span> <span class="nav-text">创建表</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E8%A1%A8"><span class="nav-number">2.</span> <span class="nav-text">删除表</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%A1%A8%E5%AE%9A%E4%B9%89%E6%9B%B4%E6%96%B0"><span class="nav-number">3.</span> <span class="nav-text">表定义更新</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E6%9F%A5%E8%AF%A2"><span class="nav-number">4.</span> <span class="nav-text">基础查询</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%81%9A%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="nav-number">5.</span> <span class="nav-text">聚合查询</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0"><span class="nav-number">6.</span> <span class="nav-text">数据更新</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%A4%8D%E6%9D%82%E6%9F%A5%E8%AF%A2"><span class="nav-number">7.</span> <span class="nav-text">复杂查询</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E3%80%81%E8%B0%93%E8%AF%8D%E3%80%81case"><span class="nav-number">8.</span> <span class="nav-text">函数、谓词、case</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%9B%86%E5%90%88%E8%BF%90%E7%AE%97"><span class="nav-number">9.</span> <span class="nav-text">集合运算</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SQL%E9%AB%98%E7%BA%A7%E5%A4%84%E7%90%86"><span class="nav-number">10.</span> <span class="nav-text">SQL高级处理</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SQL%E4%B9%A6%E5%86%99%E5%92%8C%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"><span class="nav-number">11.</span> <span class="nav-text">SQL书写和执行顺序</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">12.</span> <span class="nav-text">MySQL数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E6%95%B0%E5%80%BC%E7%B1%BB%E5%9E%8B"><span class="nav-number">12.1.</span> <span class="nav-text">1 数值类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-%E6%95%B4%E6%95%B0%E7%B1%BB%E5%9E%8B"><span class="nav-number">12.1.1.</span> <span class="nav-text">1.1 整数类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-%E6%B5%AE%E7%82%B9%E7%B1%BB%E5%9E%8B"><span class="nav-number">12.1.2.</span> <span class="nav-text">1.2 浮点类型</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E7%B1%BB%E5%9E%8B"><span class="nav-number">12.2.</span> <span class="nav-text">2 日期和时间类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-YEAR-%E7%B1%BB%E5%9E%8B"><span class="nav-number">12.2.1.</span> <span class="nav-text">2.1 YEAR 类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-TIME-%E7%B1%BB%E5%9E%8B"><span class="nav-number">12.2.2.</span> <span class="nav-text">2.2 TIME 类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-DATE-%E7%B1%BB%E5%9E%8B"><span class="nav-number">12.2.3.</span> <span class="nav-text">2.3 DATE 类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-DATETIME-%E7%B1%BB%E5%9E%8B"><span class="nav-number">12.2.4.</span> <span class="nav-text">2.4 DATETIME 类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-TIMESTAMP-%E7%B1%BB%E5%9E%8B"><span class="nav-number">12.2.5.</span> <span class="nav-text">2.5 TIMESTAMP 类型</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B"><span class="nav-number">12.3.</span> <span class="nav-text">3 字符串类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-CHAR-%E5%92%8C-VARCHAR-%E7%B1%BB%E5%9E%8B"><span class="nav-number">12.3.1.</span> <span class="nav-text">3.1 CHAR 和 VARCHAR 类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-TEXT-%E7%B1%BB%E5%9E%8B"><span class="nav-number">12.3.2.</span> <span class="nav-text">3.2 TEXT 类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-ENUM-%E7%B1%BB%E5%9E%8B"><span class="nav-number">12.3.3.</span> <span class="nav-text">3.3 ENUM 类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-SET-%E7%B1%BB%E5%9E%8B"><span class="nav-number">12.3.4.</span> <span class="nav-text">3.4 SET 类型</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%B1%BB%E5%9E%8B"><span class="nav-number">12.4.</span> <span class="nav-text">4 二进制类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-BIT-%E7%B1%BB%E5%9E%8B"><span class="nav-number">12.4.1.</span> <span class="nav-text">4.1 BIT 类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-BINARY-%E5%92%8C-VARBINARY-%E7%B1%BB%E5%9E%8B"><span class="nav-number">12.4.2.</span> <span class="nav-text">4.2 BINARY 和 VARBINARY 类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-BLOB-%E7%B1%BB%E5%9E%8B"><span class="nav-number">12.4.3.</span> <span class="nav-text">4.3 BLOB 类型</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">fangweikang</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
